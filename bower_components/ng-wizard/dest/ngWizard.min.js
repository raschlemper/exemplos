angular.module("ngWizard",["ui.bootstrap","ngAnimate","templates"]).directive("wizard",["$window","$q",function(a,b){"use strict";return{restrict:"E",transclude:!0,scope:{currentStepNumber:"=",submit:"&"},templateUrl:"src/wizardTemplate.html",controller:function(a){a.currentStepNumber=a.currentStepNumber||0,a.getCurrentStep=function(){return a.steps[a.currentStepNumber]},this.getCurrentStep=a.getCurrentStep,a.goToStepByReference=function(b){var c=a.steps.indexOf(b);return a.goToStep(c)};var c=function(b){return b<a.steps.length&&b>=0};a.canGoToStep=function(b){if(!c(b))return!1;var d=a.steps[b];return a.getStepState(d)!=a.stepStatesEnum.disabled},a.goToStep=function(b){return a.canGoToStep(b)?(a.currentStepNumber=b,!0):!1},a.getStepState=function(b){return b.requiredStepNumber&&a.getStepState(a.steps[b.requiredStepNumber])!=a.stepStatesEnum.complete?a.stepStatesEnum.disabled:b.stepForm.$valid?a.stepStatesEnum.complete:a.stepStatesEnum.ready},a.stepStatesEnum={disabled:0,ready:1,complete:2},a.goToNext=function(){a.goToStep(a.currentStepNumber+1)},a.hasNext=function(){return a.steps.length>a.currentStepNumber+1&&a.getStepState(a.steps[a.currentStepNumber+1])!=a.stepStatesEnum.disabled},a.goToPrevious=function(){a.goToStep(a.currentStepNumber-1)},a.hasPrevious=function(){return a.currentStepNumber>0},a.getProgressPercentage=function(){var b=a.steps.filter(function(b){return a.getStepState(b)==a.stepStatesEnum.complete});return b.length/a.steps.length*100},a.steps=[],this.registerStep=function(b){a.steps.push(b)},this.unregisterStep=function(b){var c=a.steps.indexOf(b);c>=0&&a.steps.splice(c,1)},a.isSubmittable=function(){return a.steps.every(function(b){return a.getStepState(b)==a.stepStatesEnum.complete})},a.submitting=!1,a.onSubmitClicked=function(){a.submitting=!0,b.when(a.submit()).then(function(){a.submitting=!1})},a.$watch("currentStepNumber",function(b,c){b!=c&&(a.canGoToStep(b)?a.getCurrentStep().entered():a.currentStepNumber=c&&a.canGoToStep(c)?c:0)}),a.$watch("steps.length",function(){a.getCurrentStep()||(a.currentStepNumber=0)},!0)}}}]).directive("wizardStep",function(){return{require:"^wizard",restrict:"E",transclude:!0,scope:{title:"@",requiredStepNumber:"@",entered:"&",animation:"@"},template:"<ng-form name='stepForm' ng-show='isActive()' class='wizard-step animate'  ng-class='animation || \"slide\"'><ng-transclude></ng-transclude></ng-form>",link:function(a,b,c,d){d.registerStep(a),a.isActive=function(){return a==d.getCurrentStep()},a.$on("$destroy",function(){d.unregisterStep(a)})}}}),angular.module("templates",["src/wizardTemplate.html"]),angular.module("src/wizardTemplate.html",[]).run(["$templateCache",function(a){a.put("src/wizardTemplate.html",'<div class="row wizard-container">\n    <div class="col-md-3 col-xs-12">\n        <ul class="nav nav-pills nav-stacked wizard-sidebar">\n            <li tooltip="{{getProgressPercentage() | number : 2}}%">\n                <progressbar value="getProgressPercentage()" type="{{getProgressPercentage() == 100 ? \'success\' : \'default\'}}"></progressbar>\n            </li>\n            <li ng-repeat="step in steps" ng-class="{disabled: getStepState(step) == stepStatesEnum.disabled, active: getCurrentStep() == step}"\n                ng-click="goToStepByReference(step)" ng-disabled="getStepState(step) == stepStatesEnum.disabled">\n                <a>\n                    {{step.title}} <i class="fa fa-check" ng-show="getStepState(step) == stepStatesEnum.complete"></i>\n                </a>\n            </li>\n        </ul>\n    </div>\n    <div class="col-md-9 col-xs-12 wizard-main">\n        <ul class="pager">\n            <li class="previous" ng-class="{disabled: !hasPrevious()}"><a href="#" ng-click="goToPrevious()"><i class="fa fa-arrow-circle-left"></i> Previous</a></li>\n            <li ng-repeat="step in steps">\n                <i class="fa" ng-class="{\'fa-circle-o disabled\': getStepState(step) == stepStatesEnum.disabled, \'fa-circle\': getStepState(step) == stepStatesEnum.complete, \'fa-circle-o\': getStepState(step) == stepStatesEnum.ready, selected: getCurrentStep() == step}"\n                   ng-click="goToStepByReference(step)" tooltip="{{step.title}}"></i>\n            </li>\n            <li class="next" ng-class="{disabled: !hasNext()}"><a href="#" ng-click="goToNext()">Next <i class="fa fa-arrow-circle-right"></i></a></li>\n        </ul>\n        <div class="wizard-step-container" ng-transclude></div>\n    </div>\n    <div class="row">\n        <div class="col-xs-12">\n            <!--Don\'t know why, but ng-hide doesn\'t work here, use ng-class instead-->\n            <button class="btn btn-primary btn-block submit" ng-class="{\'ng-hide\': !isSubmittable()}" ng-click="onSubmitClicked()" ng-disabled="submitting">Submit <i class="fa fa-circle-o-notch fa-spin" ng-show="submitting"></i></button>\n        </div>\n    </div>\n</div>')}]);